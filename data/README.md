# Data Preparation for SIR Model Simulation

This document outlines the required data files and their expected structure, shapes, and types for running the SIR model simulation. Please ensure your input data adheres to these specifications.



## 1. Main Simulation Data File

**Filename:** Provided by the `input_data_name` argument (e.g., `Input_SIR_example.pkl`)   
**File Format:** Pickle serialized file (`.pkl`) generated by `pickle.dump`   
**Usage:** Required for running the SIR *model simulation* (`run.py`, `run_hypertune.py`, `run_null_model.py`) and *summary statistics* (`run_summary_one_conn.py`, `run_summary_all_conns.py`).

**Expected Data Structure:**  
A Python dictionary containing:
- **`tau`** (`args.simulated_protein`, should change if user want to simulate other protein):
  - **Type:** `pandas.DataFrame`
  - **Shape:** `(n_regions, protein_types)`
  - **Description:** Contains observed tau values with brain regions as rows and tau types (presence or load) as columns.
- **`conn`**:
  - **Type:** `dict`
  - **Expected Sub-keys:**
    - **`conn`**:
      - **Type:** Array-like (`numpy.ndarray`)
      - **Shape:** `(n_regions, n_regions)`
      - **Description:** Connectivity matrix representing inter-regional connections, input as `SC_den` in SIR simulation.
    - **`SC_len`**:
      - **Type:** Array-like (`numpy.ndarray`)
      - **Shape:** `(n_regions, n_regions)`
      - **Description:** Matrix representing inter-regional connections length, i.e. fiber length of structral connecvity, input as `SC_len` in SIR simulation.
      - **Note:** Inproper valued `SC_len` might lead to errors when running the simulation. Invalid value when `(Pnor * v) / SC_len` or ``(Pmis * v) / SC_len`` (line 218, 383, and 394 in `simulated_atrophy.py`)
    - **`name`**:
      - **Type:** List of strings
      - **Shape:** `(n_regions,)`
      - **Description:** Region names corresponding to the connectivity matrix.
    - **`ROI_size`**:
      - **Type:** Dictionary
      - **Shape:** It should have `n_regions` keys; `{region_name: region size}`
      - **Description:** Sizes (e.g., volume or area) for each region of interest (ROI).

## 2. Regional vulnerability Data File (Optional)

**Filename:** Provided by the `regional_variable_file` argument (e.g., `regional_vulnerability_example.csv`)  
**File Format:** CSV  
**Usage:** Required for running the SIR *model simulation* (`run.py`, `run_hypertune.py`, `run_null_model.py`), if user wants to simulate with reigonal vulnerabilities.

**Expected Data Structure:**  
- **Index:** Region labels (should match the connectivity matrix)
- **Shape:** `(n_regions, n_regional_vulnerability_types)`
- **Description:** Contains regional vulnerability data for simulation parameters (e.g., synthesis, spread, misfold, clearance rates).


## 3. All Connectivity Matrices File (Optional)

**Filename:** Provided by the `connectivity_file` argument (e.g., `Connectomes_all.pkl`)  
**File Format:** Pickle serialized file (`.pkl`) generated by `pickle.dump`  
**Usage:** Required for running the SIR *model simulation* (`run_hypertune.py`) and *summary statistics* (`run_summary_all_conns.py`).

**Expected Data Structure:**  
A Python dictionary with:
- **Connectivity 1**:
  - **Type:** Array-like (`numpy.ndarray`)
  - **Shape:** `(n_regions, n_regions)`
  - **Description:** Connectivity matrix of connectivity type 1 representing inter-regional connections, input as `SC_den` in SIR simulation.
- **Connectivity 2**:
  - **Type:** Array-like (`numpy.ndarray`)
  - **Shape:** `(n_regions, n_regions)`
  - **Description:** Connectivity matrix of connectivity type 2 representing inter-regional connections, input as `SC_den` in SIR simulation.
- ...
- **Connectivity N**:
  - **Type:** Array-like (`numpy.ndarray`)
  - **Shape:** `(n_regions, n_regions)`
  - **Description:** Connectivity matrix of connectivity type N representing inter-regional connections, input as `SC_den` in SIR simulation.
- **`labels`**:
  - **Type:** List of strings
  - **Shape:** `(n_regions,)`
  - **Description:** Region names corresponding to the connectivity matrix.


## 4. All Null Connectivity Matrices File (Optional) 

**Filename:** Provided by the `connectivity_file` argument (e.g., `Null_connectomes_all.pkl`)  
**File Format:** Pickle serialized file (`.pkl`) generated by `pickle.dump`  
**Usage:** Required for running the SIR *model simulation* (`run_null_model.py`).  

**Expected Data Structure:**  
A Python dictionary with:
- **Null Connectivity 1**:
  - **Type:** Array-like (`numpy.ndarray`)
  - **Shape:** `(n_nulls, (n_regions, n_regions))`
  - **Description:** Represents the N null connectivity between brain regions for connectivity type 1.
- **Null Connectivity 2**:
  - **Type:** Array-like (`numpy.ndarray`)
  - **Shape:** `(n_nulls, (n_regions, n_regions))`
  - **Description:** Represents the N null connectivity between brain regions for connectivity type 2.
- ...
- **Null Connectivity N**:
  - **Type:** Array-like (`numpy.ndarray`)
  - **Shape:** `(n_nulls, (n_regions, n_regions))`
  - **Description:** Represents the N null connectivity between brain regions for connectivity type N.
- **`labels`**:
  - **Type:** List of strings
  - **Shape:** `(n_regions,)`
  - **Description:** Region names corresponding to the connectivity matrix.


## 5. Subtype Data File (Optional)

**Filename:** Provided by the `subtype_file` argument (e.g., `Tau_subtypes_example.csv`)  
**File Format:** CSV (`pandas.DataFrame`)   
Required for running the SIR *model simulation* (`run.py`, `run_hypertune.py`, `run_null_model.py`), if user wants to run for different subtypes. 


**Expected Data Structure:**  
- **Shape:** `(n_subtypes, n_regions)`
- **Description:** Contains observed tau values for different subtypes. 


## Note
Please ensure that all your data files conform to the above specifications before running the SIR model simulation.

Data examples are provided in the `data/` directory for reference.

